{{- template "common.configmap" (list . "walmart-integration.configmap") -}}
{{- define "walmart-integration.configmap" -}}
data:
  {{ .Values.envconsul.configFileName }}: |-
    pristine = {{ .Values.envconsul.pristine }}
    sanitize = {{ .Values.envconsul.sanitize }}
    upcase = {{ .Values.envconsul.upcase }}
    {{- range $index, $secret := .Values.envconsul.secrets }}
    secret {
      path = {{ $secret.path | quote }}
      no_prefix = {{ default "true" $secret.noPrefix }}
    }
    {{- end }}
    {{- range $index, $prefix :=.Values.envconsul.prefixes }}
    prefix {
      path = {{ $prefix.path | quote }}
    }
    {{- end }}
  {{ .Values.walmartTrustStoreConfiguration.scriptName }}: |
{{ .Files.Get "init/truststore-gen.sh" | indent 4 }}
{{- end }}
